var fs = require('fs');
var jspath = require("jspath");
var textsCfg = require("./config").get('texts');

/**
 * Получить список текстов
 *
 * @param {Object} params
 * returns json
 */
exports.getBookList = function(params) {
    var dirs = fs.readdirSync(params.textsFolder);

    if (dirs.length === 0) {
        console.log('Опасность! Каталог с текстами пуст');
        return [];
    }

    var tocList = dirs
            .filter(function(bookId){
                // Игнорирую служеные файлы на fs
                return bookId.indexOf('.') === -1
            })
            .map(function(bookId){
                return jspath('.{.id === $bookId}[0]', textsCfg.bookList, {bookId: bookId});
            });

    return tocList;
};
